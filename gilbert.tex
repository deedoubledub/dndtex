\documentclass{book}
\pagestyle{empty}

\usepackage{dnd}

%character data
%header
\newcommand{\CharacterName}{Gilbert Windham}
\newcommand{\Class}{Wizard}
\newcommand{\Level}{5}
\newcommand{\Background}{Archaeologist}
\newcommand{\PlayerName}{deedoubledub}
\newcommand{\Race}{Variant Human}
\newcommand{\Alignment}{Chaotic Good}
\newcommand{\XP}{(milestone)}

%ability scores
\newcommand{\STR}{8}
\newcommand{\DEX}{14}
\newcommand{\CON}{13}
\newcommand{\INT}{20}
\newcommand{\WIS}{12}
\newcommand{\CHA}{10}

%proficiencies
\newcommand{\ProfINTsave}{true}
\newcommand{\ProfWISsave}{true}
\newcommand{\ProfArcana}{true}
\newcommand{\ProfHistory}{true}
\newcommand{\ProfInvestigation}{true}
\newcommand{\ProfPerformance}{true}
\newcommand{\ProfReligion}{true}
\newcommand{\ProfSurvival}{true}

\newcommand{\ProfArmor}{Light Armor}
\newcommand{\ProfWeapons}{Crossbow (Light), Dagger, Dart,\\ Quarterstaff, Sling, Rapier}
\newcommand{\ProfTools}{Cartographer's Tools}
\newcommand{\ProfLanguages}{Common, Draconic, Elvish}

%combat
\newcommand{\BaseArmor}{10}
\newcommand{\Armor}{2}
\newcommand{\Speed}{30ft.}

%hit points
\FPeval{\BaseHP}{6+4+4+4} %add rolls at each level

%hit dice
\newcommand{\HitDice}{d6}

%actions
\newcommand{\Actions}{
  \textbf{Bonus Actions:\\} Telekinetic - Shove\\
  You can telekinetically shove a creature you can see within \textbf{30 ft.}
  The target must succeed on a \textbf{STR save} or be \textbf{moved 5 ft.
  toward you or away from you}. A creature can willingly fail.\\

  Bladesong \textbullet\ \ProficiencyBonus/Long Rest \textbullet\ Lasts \textbf{1 minute}\\
  \textbf{\texttt{+}\INTmod\ AC}, \textbf{\texttt{+}10 ft.} walking speed, \textbf{advantage on
  Acrobatics checks}, \textbf{\texttt{+}\INTmod} to \textbf{CON saves to maintain concentration}\\

  \textbf{Special Actions:\\} Arcane Recovery \textbullet\ 1/Long Rest\\
  Recover spell slots of a combined level up to half your wizard level (rounded up).
  The slots must be 5th level or lower.\\
}

%attacks
\newcommand{\Attacks}{
  \attack{Rapier}{5ft.}{}{\texttt{+}\FPeval{\RapierHit}{trunc(\ProficiencyBonus+\DEXmod:0)}\RapierHit}{1d8\texttt{+}\DEXmod}{piercing}{Finesse}\\
  \attack{Dagger}{5ft.}{20(60)}{\texttt{+}\FPeval{\DaggerHit}{trunc(\ProficiencyBonus+\DEXmod:0)}\DaggerHit}{1d4\texttt{+}\DEXmod}{piercing}{Finesse, Light, Thrown}\\
  \attack{Whip}{10ft.}{}{\texttt{+}\DEXmod}{1d4\texttt{+}\DEXmod}{slashing}{Finesse, Reach}\\\\
  \attack{Acid Splash}{}{60}{\FPeval{\AcidSplashSave}{trunc(8+\ProficiencyBonus+\INTmod:0)}\AcidSplashSave\ DEX}{1d6}{acid}{V,S}\\
  \attack{Fire Bolt}{}{120ft.}{\texttt{+}\FPeval{\FireBoltHit}{trunc(\ProficiencyBonus+\INTmod+\SpellModBonus:0)}\FireBoltHit}{1d10}{fire}{V,S}\\
  \attack{Ray of Frost}{}{60}{\texttt{+}\FPeval{\RayFrostHit}{trunc(\ProficiencyBonus+\INTmod+\SpellModBonus:0)}\RayFrostHit}{1d8}{cold}{V,S}\\
  \attack{Shocking Grasp}{}{Touch}{\texttt{+}\FPeval{\ShockingGraspHit}{trunc(\ProficiencyBonus+\INTmod+\SpellModBonus:0)}\ShockingGraspHit}{1d8}{lightning}{V,S}
}

%spellcasting
\newcommand{\SpellAbility}{INT}
\newcommand{\SpellModBonus}{1} %locket

%description header
\newcommand{\Age}{32}
\newcommand{\Height}{6' 2"}
\newcommand{\Weight}{200lb}
\newcommand{\Eyes}{Gray}
\newcommand{\Skin}{Pale}
\newcommand{\Hair}{Light Brown}

%equipment
\newcommand{\Equipment}{
  %name qty wt cost notes
  \dnditem{Rapier}{1}{2}{25}{\tiny{martial, finesse}}\\
  \dnditem{Dagger}{2}{2}{4}{\tiny{smpl, fin., light, thrown, range (20/60)}}\\
  \dnditem{Dagger}{1}{1}{5}{\tiny{from Udarth armory, DM said 5GP}}\\
  \dnditem{Whip}{1}{3}{2}{martial, finesse, reach}\\
  \dnditem{Spellbook}{1}{3}{50}{utility}\\
  \dnditem{Studded Leather}{1}{13}{45}{light armor, AC 12}\\
  \dnditem{Traveler's Clothes}{1}{4}{2}{social, outerwear}\\
  \dnditem{The Burnt Book}{1}{-}{-}{journal, spellbook}\\
  \dnditem{\textbf{Backpack}}{1}{5}{2}{capacity: 1ft$^3$/30\tiny{lb.}}\\
  \dnditem{Ink Pen}{1}{-}{0.02}{communication, social, utility}\\
  \dnditem{Ink \scriptsize{(1 oz. bottle)}}{1}{-}{10}{\tiny{comm, social, utility, consumable}}\\
  \dnditem{Little Bag of Sand}{1}{-}{-}{utility}\\
  \dnditem{Small Knife}{1}{-}{-}{utility}\\
  \dnditem{Map Case \& Map}{1}{-}{-}{Is this a crypt in Udarth?}\\
  \dnditem{Cartographer's Tools}{1}{6}{15}{}\\
  \dnditem{Ornate Compass}{1}{-}{25}{}\\
  \dnditem{Potion of Healing}{2}{.5}{50}{regain 2d4\texttt{+}2 hit points}\\
  \dnditem{Dragon Claw}{1}{}{?}{}\\
  \dnditem{Rune-Marked Business Card}{1}{-}{-}{Udarth-related rune}\\
  \dnditem{Tusk Love}{1}{-}{-}{book}\\
  \dnditem{Spell Scrolls}{4}{-}{-}{\tiny{DispelM, TeleCircle, HoldP, MagicM}}\\
  \dnditem{Scroll of Lesser Restoration}{1}{-}{-}{Cleric/Druid give to Trig/Kairon}\\
  \dnditem{\textbf{Component Pouch}}{1}{2}{25}{spellcasting focus}\\
  \dnditem{Pearl}{1}{-}{100}{}\\
  \dnditem{Glow Nut}{1}{-}{-}{shake for 1min, 10ft glow}\\
  \footnotesize{\textbf{Attuned}}\\
  \dnditem{Locket}{1}{-}{1200}{\tiny{\texttt{+}1 spell atk, reroll 1 dmg die/lng rst}}\\
}

%money
\newcommand{\CP}{98}
\newcommand{\SP}{0}
\newcommand{\GP}{162}
\newcommand{\EP}{0}
\newcommand{\PP}{0}

%backstory
\newcommand{\Backstory}{
  Ever since he was a child, Gilbert heard tales about the ancient lost city of Udarth. Not much is known about the city, but it is said to have been ruled by a Magocracy of Dragonborn sorcerers. He has spent the intervening years studying Draconic languages and history while becoming an archaeologist. One day, he hopes to earn his place in the history books by finding Udarth and uncovering its secrets.\\

  On his very first dig expedition, Gilbert uncovered a dusty old bullwhip. He keeps it strapped to his side to this day as a souvenir. On that same dig, he also discovered a wooden map case containing what appears to be the layout of a crypt. The map is covered in Draconic symbols and writing. It must be linked to Udarth somehow!\\

  During his most recent archaeological excursion, Gilbert saved a colleague from great harm in the most unusual way. A rope snapped from a pulley system, causing large debris to swing toward a fellow digger. Gilbert cried out and felt completely powerless to stop a tragic accident. Then suddenly, Gilbert discovered an unknown talent, and he was able to telekinetically shove his friend out of harm's way.\\

  After this sudden discovery of telekinetic ability, Gilbert spent several weeks in the library researching everything he could find about magic and spellcasting. During this time, he has learned to copy a few basic spells into his own spellbook and has gained a rudimentary understanding of the art. In the very last text that he scoured, Gilbert found a reference to a place called Dragon's Rest where it might be possible to learn more magic and to develop this new skill. Gilbert packed his belongings and bartered passage on a ship to Stormwreck Isle the very next day.\\

  The adventure begins...
}

%traits
\newcommand{\PersonalityTraits}{
  I love a good puzzle or mystery.\\\\
  I’m happier in a dusty old tomb than I am in the centers of civilization.
}
\newcommand{\Ideals}{Preservation. That artifact belongs in a museum. (Good)}
\newcommand{\Bonds}{Ever since I was a child, I’ve heard stories about a lost city. I aim to find it, learn its secrets, and earn my place in the history books. (Udarth)}
\newcommand{\Flaws}{I have a secret fear of some common wild animal—and in my work, I see them\\ everywhere. (Snakes)}

%features
\newcommand{\Features}{
  \textbf{Prepared Spells:} \FPeval{\PreparedSpell}{trunc(\Level+\INTmod:0)}\PreparedSpell
  \hspace{1.5em}
  \textbf{Cantrips Known:} \ifthenelse{\Level > 9}{5}{\ifthenelse{\Level > 3}{4}{3}}\\

  \textbf{Spell Slots:\\}
  \setlength\tabcolsep{0.38em}
  \begin{tabular}{ c c c c c c c c c }
    \textbf{1st} & \textbf{2nd} & \textbf{3rd} & \textbf{4th} & \textbf{5th} & \textbf{6th} & \textbf{7th} & \textbf{8th} & \textbf{9th} \\
    4 & 3 & 2 & - & - & - & - & - & -
  \end{tabular}\\

  \textbf{Ritual Spells:\\} Comprehend Languages, Detect Magic, Find Familiar, Identify\\

  \textbf{Cantrip Formulas:} When you finish a long rest, you can replace one wizard cantrip with another from the wizard spell list.\\

  \textbf{Feats:\\} Telekinetic (Intelligence)
  \vspace{-\topsep}
  \begin{itemize}
    \setlength\itemsep{-0.5em}
    \item +1 INT
    \item You learn mage hand; cast it without verbal or somatic components; can be invisible; range increases by 30 feet if you already know it
    \item As a bonus action, you can try to telekinetically shove a creature
  \end{itemize}
  \textbf{Background Features:\\} Historical Knowledge (Archaeologist)\\
  When you enter a ruin or dungeon, you can correctly ascertain its original purpose and determine its builders. You can determine the monetary value of art objects more than a century old.\\\\
  \textbf{Neverwinter University Rank: 1}\\
  \vspace{-2em}
  \begin{itemize}
    \setlength\itemsep{-0.5em}
    \item Free Teleportation to Waterdeep, Baldur's Gate, Luskan, Radiant Citadel, Caer Callidyrr
    \item Discount at component shop and gift shop
  \end{itemize}
}

%generate character sheet
\begin{document}
\input{template/calculations.tex}
\main
\roleplay
\end{document}
